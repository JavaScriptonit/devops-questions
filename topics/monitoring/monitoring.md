## Вопросы:
1. С какими системами мониторинга приходилось работать?
2. Мониторинг. Какой стек использовал? (Monitoring)(ОПЫТ)
3. Логирование. Какой стек использовал? (Monitoring)(ОПЫТ)
4. Хранение логов и метрик. (Monitoring)(ОПЫТ)
5. С какими системами мониторинга приходилось работать? (Monitoring)(ОПЫТ)
6. Есть бэк-приложение. HTTP сервер на Spring. Нужно поставить на мониторинг. Какие метрики смотрел бы в 1ую очередь? (Monitoring)
7. Сборка и визуализация логов в Grafana с использованием Loki. (Monitoring)(ОПЫТ)
8. Каким образом передавались логи в хранилище? Кто отправляет/пишет их? (Loki/Kibana)


## 1. С какими системами мониторинга приходилось работать? (Monitoring)(ОПЫТ)
sber/devices/interview.md - 5. Мониторинг. Какой стек использовал?

1. Использование стека grafana + prometheus + node exporter
2. Использование Instana + Instana agents 

## 2. Мониторинг. Какой стек использовал? (Monitoring)(ОПЫТ)

Примеры использования мониторинга k8s и приложений на Linux:

### Использование стека grafana + prometheus + node exporter:
Для мониторинга кластера k8s и приложений на Linux. Этот стек позволяет собирать метрики с кластера k8s и отображать их в графическом виде с помощью Grafana. Node exporter собирает метрики с узлов кластера, а Prometheus хранит их и обеспечивает возможность запросов.

Файл конфигурации для настройки сбора метрик Prometheus:
```
prometheus.yml
```
Команда для запуска Grafana:
```
docker run -d --name=grafana -p 3000:3000 grafana/grafana
```

### Использование Instana + Instana agents:
Для мониторинга приложений на Linux. Instana предоставляет возможность мониторинга приложений в реальном времени с помощью агентов, установленных на хостах.

Команда для установки агента Instana на хосте Linux:
```
wget -O - https://setup.instana.io/agent | sh -s YOUR_AGENT_KEY
```
Файл конфигурации для настройки агента Instana:
```
instana-config.yaml
```
Команда для запуска мониторинга в реальном времени:
```
instana-agent start
```

## 3. Логирование. Какой стек использовал? (Monitoring)(ОПЫТ)

Примеры использования логирования k8s и приложений на Linux:

### Использование Loki + grafana:
Для сбора и отображения логов приложений на Linux. Loki - это система сбора и отображения логов, которая интегрируется с Grafana для отображения логов в удобном виде.

Команда для установки Loki в кластере k8s:
```
helm repo add grafana https://grafana.github.io/helm-charts
helm install loki grafana/loki-stack
```
Файл конфигурации для настройки сбора логов Loki:
```
loki-config.yaml
```

## 4. Хранение логов и метрик. (Monitoring)(ОПЫТ)

`При выборе места хранения логов и метрик учитывайте требования к безопасности, резервному копированию и доступности данных`. Также убедитесь, что выбранное решение соответствует требованиям по производительности и масштабируемости.

Для хранения больших объемов данных можно использовать специализированные хранилища, такие как `Amazon S3`, `Google Cloud Storage` или `MinIO`.

Использование базы данных для хранения логов и метрик:

В качестве базы данных можно использовать `InfluxDB`, которая специализируется на хранении временных рядов данных, что подходит для хранения метрик.
Для хранения логов можно использовать `Elasticsearch`, который также позволяет выполнять полнотекстовый поиск и анализ логов.

## 5. С какими системами мониторинга приходилось работать? (Monitoring)(ОПЫТ)
sber/devices/interview.md - 5. Мониторинг. Какой стек использовал?

1. Использование стека grafana + prometheus + node exporter
2. Использование Instana + Instana agents

## 6. Есть бэк-приложение. HTTP сервер на Spring. Нужно поставить на мониторинг. Какие метрики смотрел бы в 1ую очередь? (Monitoring)

При мониторинге бэкэнд-приложения на Spring HTTP сервере, в первую очередь стоит обратить внимание на следующие ключевые метрики:

1. **Производительность HTTP сервера**:
   - Загрузка CPU и памяти на сервере
   - Количество запросов в секунду
   - Среднее время ответа на запросы

2. **Статусы HTTP запросов**:
   - Коды ответов HTTP (200, 404, 500 и т.д.)
   - Количество успешных и неуспешных запросов

3. **Использование базы данных** (если используется):
   - Загрузка CPU и памяти на сервере базы данных
   - Количество запросов к базе данных
   - Среднее время выполнения запросов к базе данных

4. **Сборщик мусора Java**:
   - Использование памяти Java
   - Частота и длительность сборок мусора

5. **Кэширование**:
   - Попадания и промахи кэша
   - Эффективность кэширования

Для сбора и визуализации этих метрик через Grafana и Prometheus, вам потребуется настроить экспортеры для сбора метрик с HTTP сервера, базы данных (если используется) и других компонентов. Например, для сбора метрик из базы данных можно использовать экспортеры, такие как `Prometheus MySQL Exporter` или `Prometheus PostgreSQL Exporter`.

Эти метрики помогут вам отслеживать производительность и работоспособность вашего бэкэнд-приложения, а также выявлять потенциальные проблемы и улучшать его работу.

## 7. Сборка и визуализация логов в Grafana с использованием Loki. (Monitoring)(ОПЫТ)

Для логирования на проекте, где уже используется стек мониторинга Grafana + Prometheus, хорошим выбором будет использование Loki в сочетании с Grafana для хранения и визуализации журналов.

Для быстрой настройки логирования докер контейнеров на сервере Linux с использованием Loki и Grafana, вам потребуется выполнить следующие шаги:

1. **Установка и настройка Loki**:
   - Установите Loki на сервере. Можно использовать Docker:
     ```bash
     docker run -d --name loki -p 3100:3100 grafana/loki:latest
     ```
   - Убедитесь, что Loki запущен и доступен по адресу `http://localhost:3100`.

2. **Настройка логирования в докер контейнерах**:
   - Добавьте следующий параметр в запуск контейнера для отправки логов в Loki:
     ```bash
     --log-driver=loki --log-opt loki-url="http://<loki_ip>:3100/loki/api/v1/push"
     ```
   - Перезапустите контейнеры, чтобы применились изменения.

3. **Настройка Grafana для визуализации логов**:
   - Установите Grafana на сервере, если еще не установлено.
   - Добавьте источник данных Loki в Grafana, указав адрес Loki (http://localhost:3100).
   - Создайте панели для визуализации журналов из Loki.

## 8. Каким образом передавались логи в хранилище? Кто отправляет/пишет их? (Loki/Kibana)

Для передачи логов в хранилище, как Loki, так и Kibana, обычно используются агенты логирования или лог-драйверы, которые отправляют или пишут логи в соответствующее хранилище. В случае Loki, контейнеры Docker могут напрямую отправлять логи в Loki, указывая адрес Loki в параметрах запуска контейнера. Для Kibana, обычно используется Elasticsearch как хранилище логов, и логи отправляются в Elasticsearch через лог-драйверы или агенты логирования.

Примеры команд и шагов для поднятия Loki и Kibana в Docker:

1. **Loki**:
   - Запуск контейнера Loki:
     ```bash
     docker run -d --name loki -p 3100:3100 grafana/loki:latest
     ```
   - Убедитесь, что Loki доступен по адресу `http://localhost:3100`.

2. **Kibana** (с Elasticsearch):
   - Запуск контейнера Elasticsearch:
     ```bash
     docker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" docker.elastic.co/elasticsearch/elasticsearch:7.15.1
     ```
   - Запуск контейнера Kibana:
     ```bash
     docker run -d --name kibana --link elasticsearch:elasticsearch -p 5601:5601 docker.elastic.co/kibana/kibana:7.15.1
     ```
   - Убедитесь, что Kibana доступен по адресу `http://localhost:5601`.

После выполнения этих шагов, Loki и Kibana будут запущены в Docker контейнерах, и вы сможете начать отправлять и визуализировать логи в соответствующих хранилищах. Помните, что для более продуктивного использования, необходимо настроить агенты логирования в ваших контейнерах для отправки логов в Loki или Elasticsearch.